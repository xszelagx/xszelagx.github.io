<!DOCTYPE html>
<html lang="pl">

<head>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied'
        });
    </script>
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="AgOFMb0H0diUrjON6CzVKbUoCC3vLVckCswXYAPjsIo" />
    <title>Automatyzacja uprawnieÅ„ na Google Drive: Masowe udostÄ™pnianie i cofanie dostÄ™pÃ³w | MikoÅ‚aj SzelÄ…g</title>
    <meta name="description"
        content="Jak zarzÄ…dzaÄ‡ uprawnieniami setek plikÃ³w na Google Drive za pomocÄ… Apps Script. Masowe udostÄ™pnianie folderÃ³w, cofanie dostÄ™pÃ³w i audyt kto ma wglÄ…d do firmowych danych.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"></noscript>
    <link rel="preload" as="style" href="../css/styles.css">
    <link rel="stylesheet" href="../css/styles.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="../css/styles.css"></noscript>
    <link rel="canonical"
        href="https://xszelagx.github.io/blog/automatyzacja-uprawnien-google-drive-udostepnianie-apps-script.html" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "Automatyzacja uprawnieÅ„ na Google Drive: Masowe udostÄ™pnianie i cofanie dostÄ™pÃ³w (Apps Script)",
      "description": "Jak zarzÄ…dzaÄ‡ uprawnieniami setek plikÃ³w na Google Drive za pomocÄ… Apps Script. Masowe udostÄ™pnianie folderÃ³w, cofanie dostÄ™pÃ³w i audyt kto ma wglÄ…d do firmowych danych.",
      "author": {
        "@type": "Person",
        "name": "MikoÅ‚aj SzelÄ…g",
        "url": "https://xszelagx.github.io/"
      },
      "publisher": {
        "@type": "Person",
        "name": "MikoÅ‚aj SzelÄ…g"
      },
      "datePublished": "2026-02-28",
      "url": "https://xszelagx.github.io/blog/automatyzacja-uprawnien-google-drive-udostepnianie-apps-script.html"
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "MikoÅ‚aj SzelÄ…g",
        "item": "https://xszelagx.github.io/"
      },{
        "@type": "ListItem",
        "position": 2,
        "name": "Blog",
        "item": "https://xszelagx.github.io/blog.html"
      },{
        "@type": "ListItem",
        "position": 3,
        "name": "Automatyzacja uprawnieÅ„ na Google Drive",
        "item": "https://xszelagx.github.io/blog/automatyzacja-uprawnien-google-drive-udostepnianie-apps-script.html"
      }]
    }
    </script>
    <link rel="icon" type="image/png" href="../favicon.png?v=2">
    <link rel="icon" type="image/x-icon" href="../favicon.ico?v=2">
    <link rel="apple-touch-icon" href="../apple-touch-icon.png?v=2">
</head>

<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MLPQLFN4" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>
    <header class="glass-nav">
        <div class="container nav-container">
            <a href="../index.html" class="logo">SzelÄ…g<span>.</span>Data</a>
            <nav>
                <ul class="nav-links">
                    <li><a href="../">Strona GÅ‚Ã³wna</a></li>
                    <li><a href="../#about">Dlaczego Warto?</a></li>
                    <li><a href="../#services">UsÅ‚ugi</a></li>
                    <li><a href="../#case-studies">Realizacje</a></li>
                    <li><a href="../blog.html">Blog</a></li>
                    <li><a href="../#contact" class="btn-primary-small">Kontakt</a></li>
                </ul>
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <article>
            <header class="post-header">
                <div class="container">
                    <a href="../blog.html"
                        style="color: var(--text-muted); text-decoration: none; display: inline-block; margin-bottom: 30px;">&larr;
                        WrÃ³Ä‡ do artykuÅ‚Ã³w</a>
                    <div class="post-meta">
                        <span class="post-tag">Automatyzacja Google Drive</span>
                        <span>28 Lutego 2026</span>
                        <span>â±ï¸ 7 min czytania</span>
                    </div>
                    <h1 class="post-title">Automatyzacja uprawnieÅ„ na <span class="gradient-text">Google Drive</span>:
                        Masowe udostÄ™pnianie i cofanie dostÄ™pÃ³w</h1>
                </div>
            </header>

            <div class="container">
                <div class="post-layout">
                    <div class="post-content">
                        <p><strong>Nowy pracownik doÅ‚Ä…czyÅ‚ do zespoÅ‚u i potrzebuje dostÄ™pu do 47 folderÃ³w na Dysku
                                firmowym.</strong> KtoÅ› odszedÅ‚ z firmy i trzeba cofnÄ…Ä‡ mu uprawnienia w 120 plikach.
                            Audytor pyta: â€kto ma dostÄ™p do tego folderu z danymi osobowymi?" A Ty klikasz w
                            â€UdostÄ™pnij" po kolei, plik po pliku. Brzmi znajomo?</p>

                        <h2>Problem: rÄ™czne zarzÄ…dzanie uprawnieniami nie skaluje siÄ™</h2>
                        <p>W firmie z 20+ osobami i setkami dokumentÃ³w na Dysku Google, model â€klik-klik-klik
                            w udostÄ™pnianie" generuje trzy powaÅ¼ne ryzyka:</p>
                        <ul>
                            <li><strong>BezpieczeÅ„stwo</strong> â€” byÅ‚y pracownik nadal ma dostÄ™p do wraÅ¼liwych danych,
                                bo ktoÅ› zapomniaÅ‚ cofnÄ…Ä‡ uprawnienia. WiÄ™cej o tym w moim poÅ›cie o <a
                                    href="./jak-zabezpieczyc-dane-udostepnione-arkusze-google.html">zabezpieczaniu
                                    danych w Arkuszach Google</a>.</li>
                            <li><strong>Compliance</strong> â€” brak audytu kto co widzi. Na pytanie RODO nie jesteÅ›
                                w stanie odpowiedzieÄ‡ w 24h.</li>
                            <li><strong>Czas</strong> â€” onboarding IT nowego pracownika trwa godzinÄ™ zamiast minuty.
                            </li>
                        </ul>

                        <h2>Skrypt: masowe udostÄ™pnianie folderu nowemu pracownikowi</h2>
                        <p>PoniÅ¼szy skrypt przyjmuje listÄ™ folderÃ³w z Google Sheets i udostÄ™pnia je wskazanemu
                            uÅ¼ytkownikowi z okreÅ›lonymi uprawnieniami:</p>

                        <pre><code>function bulkShareFolders() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet()
                  .getSheetByName('Onboarding');
  const rows = sheet.getDataRange().getValues();

  // Kolumny: A=Email, B=Folder ID, C=Rola (VIEWER/EDITOR)
  for (let i = 1; i < rows.length; i++) {
    const email = rows[i][0];
    const folderId = rows[i][1];
    const role = rows[i][2] || 'VIEWER';

    try {
      const folder = DriveApp.getFolderById(folderId);
      folder.addEditor(email);  // lub addViewer()

      if (role === 'VIEWER') {
        // Najpierw dodajemy, potem zmieniamy na viewer
        folder.removeEditor(email);
        folder.addViewer(email);
      }

      sheet.getRange(i + 1, 4).setValue('âœ… UdostÄ™pniono');
    } catch (e) {
      sheet.getRange(i + 1, 4).setValue('âŒ BÅ‚Ä…d: ' + e.message);
    }
  }
}</code></pre>

                        <h2>Skrypt: cofanie dostÄ™pu po odejÅ›ciu pracownika</h2>
                        <p>RÃ³wnie waÅ¼ne jak udostÄ™pnianie jest natychmiastowe <strong>cofniÄ™cie dostÄ™pu</strong>.
                            PoniÅ¼szy skrypt przeszukuje WSZYSTKIE pliki i foldery, do ktÃ³rych dany uÅ¼ytkownik ma
                            dostÄ™p, i go usuwa:</p>

                        <pre><code>function revokeAllAccess(emailToRevoke) {
  // Przeszukaj caÅ‚oÅ›Ä‡ Drive
  const files = DriveApp.searchFiles(
    `'${emailToRevoke}' in writers or '${emailToRevoke}' in readers`
  );

  let count = 0;
  while (files.hasNext()) {
    const file = files.next();
    try {
      file.removeEditor(emailToRevoke);
    } catch(e) {}
    try {
      file.removeViewer(emailToRevoke);
    } catch(e) {}
    count++;
  }

  Logger.log(`CofniÄ™to dostÄ™p do ${count} plikÃ³w dla ${emailToRevoke}`);
  return count;
}</code></pre>

                        <h2>Audyt uprawnieÅ„: kto widzi co?</h2>
                        <p>Zanim zaczniesz automatyzowaÄ‡ udostÄ™pnianie, warto najpierw wiedzieÄ‡, jaki jest obecny
                            stan. Skrypt audytowy generuje raport w Google Sheets ze wszystkimi plikami w folderze
                            i listÄ… osÃ³b majÄ…cych do nich dostÄ™p:</p>

                        <pre><code>function auditFolderPermissions() {
  const FOLDER_ID = 'ID_FOLDERU_DO_AUDYTU';
  const folder = DriveApp.getFolderById(FOLDER_ID);
  const sheet = SpreadsheetApp.getActiveSpreadsheet()
                  .getSheetByName('Audyt');

  sheet.clear();
  sheet.appendRow(['Nazwa pliku', 'Typ', 'WÅ‚aÅ›ciciel', 'Edytorzy', 'Czytelnicy']);

  const files = folder.getFiles();
  while (files.hasNext()) {
    const file = files.next();
    const editors = file.getEditors().map(e => e.getEmail()).join(', ');
    const viewers = file.getViewers().map(v => v.getEmail()).join(', ');

    sheet.appendRow([
      file.getName(),
      file.getMimeType(),
      file.getOwner().getEmail(),
      editors,
      viewers
    ]);
  }
}</code></pre>

                        <p>Wygenerowany raport to fantastyczna baza do dalszej analizy â€” np. w <a
                                href="./monitoring-dostepow-looker-studio-bezpieczenstwo-danych.html">dashboardzie
                                monitoringu dostÄ™pÃ³w w Looker Studio</a>. MoÅ¼esz teÅ¼ naÅ‚oÅ¼yÄ‡ <a
                                href="./bezpieczenstwo-danych-row-level-security-looker-studio.html">Row-Level
                                Security</a>, Å¼eby menedÅ¼erowie widzieli tylko uprawnienia swoich zespoÅ‚Ã³w.</p>

                        <blockquote>
                            â€W firmie z 50 pracownikami to tysiÄ…ce kombinacji plik Ã— uÅ¼ytkownik. Nikt tego nie ogarnie
                            rÄ™cznie. Albo automatyzujesz zarzÄ…dzanie dostÄ™pami, albo akceptujesz, Å¼e byÅ‚y staÅ¼ysta
                            nadal czyta strategiÄ™ cenowÄ…."
                        </blockquote>

                        <h3>Best practices przy automatyzacji uprawnieÅ„</h3>
                        <ul>
                            <li><strong>Principle of Least Privilege</strong> â€” domyÅ›lnie dawaj VIEWER, EDITOR tylko
                                kiedy faktycznie potrzebny.</li>
                            <li><strong>Loguj kaÅ¼dÄ… zmianÄ™</strong> â€” zapisuj w Sheets kto, kiemu, kiedy dal/cofnÄ…Å‚
                                dostÄ™p.</li>
                            <li><strong>Regularny audyt</strong> â€” uruchamiaj skrypt audytowy co tydzieÅ„ triggerem
                                czasowym.</li>
                            <li><strong>Grupy Google</strong> â€” zamiast udostÄ™pniaÄ‡ indywidualnie, twÃ³rz grupy
                                (dziaÅ‚@firma.pl) i zarzÄ…dzaj na poziomie grupy.</li>
                        </ul>
                    </div>

                    <aside class="post-sidebar">
                        <div class="author-card">
                            <div class="author-avatar">ğŸ‘¨â€ğŸ’»</div>
                            <h3 style="margin-bottom: 5px;">MikoÅ‚aj SzelÄ…g</h3>
                            <p style="color: var(--primary); font-size: 0.9rem; margin-bottom: 15px;">Specjalista
                                BezpieczeÅ„stwa Danych & Automatyzacji</p>
                            <p style="color: var(--text-muted); font-size: 0.9rem; line-height: 1.5;">AutomatyzujÄ™
                                procesy IT, ktÃ³re kradnÄ… czas zespoÅ‚om. Od zarzÄ…dzania uprawnieniami po peÅ‚ne
                                pipeline'y danych w Google Cloud.</p>
                        </div>
                        <div class="cta-card">
                            <h3>Onboarding trwa za dÅ‚ugo?</h3>
                            <p>WdroÅ¼Ä™ automatyzacjÄ™ uprawnieÅ„, ktÃ³ra nowego pracownika ogarnie w 60 sekund, a
                                odchodzÄ…cego rozÅ‚Ä…czy natychmiast. Bezpieczna i audytowalna.</p>
                            <a href="../#contact" class="btn btn-primary"
                                style="width: 100%; text-align: center; padding: 12px;">Zamawiam automatyzacjÄ™
                                uprawnieÅ„</a>
                        </div>
                    </aside>
                </div>
            </div>
        </article>
    </main>

    <footer class="glass-footer">
        <div class="container footer-content">
            <div class="footer-logo">SzelÄ…g<span>.</span>Data</div>
            <p>&copy; <span id="year"></span> MikoÅ‚aj SzelÄ…g. Wszelkie prawa zastrzeÅ¼one.</p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/mikolaj-szelag/" target="_blank" rel="noopener noreferrer"
                    aria-label="LinkedIn">LinkedIn</a>
            </div>
        </div>
    </footer>
    <!-- Google Consent Mode v2 -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied'
        });
    </script>
    <!-- Google Tag Manager (deferred) -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-MLPQLFN4');</script>
    <!-- Google Analytics (deferred) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9N5S4NW0L8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-9N5S4NW0L8');
    </script>

    <script src="../js/script.js"></script>
</body>

</html>